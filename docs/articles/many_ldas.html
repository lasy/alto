<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Many Alignments â€¢ alto</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Many Alignments"><meta property="og:description" content="alto"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">alto</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li class="dropdown-header">Demos</li>
    <li>
      <a href="../articles/basic-alignment.html">Introduction to Alignment</a>
    </li>
    <li>
      <a href="../articles/microbiome-demo.html">Using `alto` on vaginal microbiome data</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Simulations</li>
    <li>
      <a href="../articles/lda.html">Identifying True Topics</a>
    </li>
    <li>
      <a href="../articles/background-noise.html">Characterizing Topics with Background Noise</a>
    </li>
    <li>
      <a href="../articles/strain-switching.html">Strain Switching</a>
    </li>
    <li>
      <a href="../articles/many_ldas.html">Many Alignments</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Profiling</li>
    <li>
      <a href="../articles/timing.html">Measuring Runtimes</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>





<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Many Alignments</h1>
            
      
      
      <div class="hidden name"><code>many_ldas.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we simulate from two true LDA models, one with five
topics and one null model with a single topic. We repeat the simulations
20 times each, generate alignments for each of the simulated data sets,
and visualize the alignment.</p>
<p>The packages used in this vignette are given below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MCMCpack)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: coda</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: MASS</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ##</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ## Markov Chain Monte Carlo Package (MCMCpack)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ## Copyright (C) 2003-2023 Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ##</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ## Support provided by the U.S. National Science Foundation</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ## (Grants SES-0350646 and SES-0350613)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ##</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alto)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;alto&#39;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     weights</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:MASS&#39;:</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     select</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;gridExtra&#39;</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     combine</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/krisrs1128/topic_align/main/simulations/simulation_functions.R&quot;</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">my_theme</span>()</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: [1m[22mThe `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [36mâ„¹[39m Please use the `linewidth` argument instead.</span></span></code></pre></div>
<p>The block below simulates data <code>x</code> according to an LDA
models with parameters specified above. The topics are relatively
sparse, with <span class="math inline">\(\lambda_{\beta} = 0.1\)</span>
and <span class="math inline">\(\lambda_{\gamma} = 0.5\)</span>. Each
sample has 10,000 counts.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(params)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n_sims <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>lambdas <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">beta =</span> <span class="fl">0.1</span>, <span class="at">gamma =</span> .<span class="dv">5</span>, <span class="at">count =</span> <span class="fl">1e4</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>betas_non_null <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>(K, <span class="fu">rep</span>(lambdas<span class="sc">$</span>beta, V))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>betas_null <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>(N, <span class="fu">rep</span>(<span class="dv">1</span>, V))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>gammas_non_null <span class="ot">&lt;-</span> <span class="fu">rdirichlet</span>(N, <span class="fu">rep</span>(lambdas<span class="sc">$</span>gamma, K))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>gammas_null <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>, N))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>counts_non_null <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> n_sims, <span class="fu">simulate_lda</span>(betas_non_null, gammas_non_null, <span class="at">lambda =</span> lambdas<span class="sc">$</span>count), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>counts_null <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> n_sims, <span class="fu">simulate_lda</span>(betas_null, gammas_null, <span class="at">lambda =</span> lambdas<span class="sc">$</span>count), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Next, we run the LDA models and compute the alignment.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lda_params <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span>n_models, <span class="sc">~</span> <span class="fu">list</span>(<span class="at">k =</span> .))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lda_params) <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">&quot;K&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_models)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>alignments_non_null <span class="ot">&lt;-</span> <span class="fu">lapply</span>(counts_non_null, <span class="cf">function</span>(x)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">run_lda_models</span>(lda_params, <span class="at">reset =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">align_topics</span>(<span class="at">method =</span> params<span class="sc">$</span>method)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>alignments_null <span class="ot">&lt;-</span> <span class="fu">lapply</span>(counts_null, <span class="cf">function</span>(x)</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">%&gt;%</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">run_lda_models</span>(lda_params, <span class="at">reset =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">align_topics</span>(<span class="at">method =</span> params<span class="sc">$</span>method)</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Using default value &#39;VEM&#39; for &#39;method&#39; LDA parameter.</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plots_non_null <span class="ot">=</span> <span class="fu">lapply</span>(alignments_non_null, plot)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>plots_null <span class="ot">=</span> <span class="fu">lapply</span>(alignments_null, plot)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">=</span> <span class="fu">c</span>(plots_non_null, plots_null)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots, <span class="at">cols =</span> <span class="dv">4</span>, <span class="at">layout_matrix =</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<p><img src="many_ldas_files/figure-html/unnamed-chunk-4-1.png" width="960" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>layout_matrix <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>layout_matrix <span class="ot">=</span> <span class="fu">rbind</span>(layout_matrix, <span class="dv">21</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>max_coherence <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plots_non_null <span class="ot">=</span> <span class="fu">lapply</span>(alignments_non_null, <span class="cf">function</span>(a) {</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(a, <span class="at">color_by =</span> <span class="st">&quot;coherence&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Coherence&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_coherence), <span class="at">low =</span> <span class="st">&quot;brown1&quot;</span>, <span class="at">high =</span> <span class="st">&quot;cornflowerblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>plots_null <span class="ot">=</span> <span class="fu">lapply</span>(alignments_null, <span class="cf">function</span>(a) {</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(a, <span class="at">color_by =</span> <span class="st">&quot;coherence&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Coherence&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_coherence), <span class="at">low =</span> <span class="st">&quot;brown1&quot;</span>, <span class="at">high =</span> <span class="st">&quot;cornflowerblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">=</span> <span class="fu">c</span>(plots_non_null, plots_null)</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>l <span class="ot">=</span> <span class="fu">get_legend</span>(<span class="fu">qplot</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_coherence)) <span class="sc">+</span> <span class="fu">scale_fill_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Coherence&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_coherence), <span class="at">low =</span> <span class="st">&quot;brown1&quot;</span>, <span class="at">high =</span> <span class="st">&quot;cornflowerblue&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>))</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: [1m[22m`qplot()` was deprecated in ggplot2 3.4.0.</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>plots[[<span class="dv">21</span>]] <span class="ot">=</span> l</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots, <span class="at">layout_matrix =</span> layout_matrix)</span></code></pre></div>
<p><img src="many_ldas_files/figure-html/unnamed-chunk-5-1.png" width="960" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>max_refinement <span class="ot">=</span> <span class="dv">9</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plots_non_null <span class="ot">=</span> <span class="fu">lapply</span>(alignments_non_null, <span class="cf">function</span>(a) {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(a, <span class="at">color_by =</span> <span class="st">&quot;refinement&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_continuous_divergingx</span>(<span class="at">name =</span> <span class="st">&quot;Refinement&quot;</span>, <span class="at">mid =</span> <span class="dv">1</span>, <span class="at">palette =</span> <span class="st">&quot;Roma&quot;</span>, <span class="at">p1 =</span> .<span class="dv">005</span>, <span class="at">p3 =</span> .<span class="dv">005</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_refinement)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>plots_null <span class="ot">=</span> <span class="fu">lapply</span>(alignments_null, <span class="cf">function</span>(a) {</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(a, <span class="at">color_by =</span> <span class="st">&quot;refinement&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_continuous_divergingx</span>(<span class="at">name =</span> <span class="st">&quot;Refinement&quot;</span>, <span class="at">mid =</span> <span class="dv">1</span>, <span class="at">palette =</span> <span class="st">&quot;Roma&quot;</span>, <span class="at">p1 =</span> .<span class="dv">005</span>, <span class="at">p3 =</span> .<span class="dv">005</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, max_refinement)) <span class="sc">+</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1m[22mScale for [32mfill[39m is already present.</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Adding another scale for [32mfill[39m, which will replace the existing scale.</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">=</span> <span class="fu">c</span>(plots_non_null, plots_null)</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>l <span class="ot">=</span> <span class="fu">get_legend</span>(plots[[<span class="dv">1</span>]] <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>))</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>plots[[<span class="dv">21</span>]] <span class="ot">=</span> l</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots, <span class="at">layout_matrix =</span> layout_matrix)</span></code></pre></div>
<p><img src="many_ldas_files/figure-html/unnamed-chunk-6-1.png" width="960" /></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p><p>Developed by Kris Sankaran, Laura Symul, Julia Fukuyama.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>
